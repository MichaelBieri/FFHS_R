---
title: "Semsterarbeit_Teil1a"
author: "MB"
date: "2024-03-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Lernziel
- Ich kann (eigene) Daten (ggf. unterschiedliche Formate) in R einlesen/importieren und dabei Importfunktionen anpassen. 
- Ich kann mir einen Überblick über Datentypen, Grössen,  Lagemasse, Streumasse etc.  verschaffen.
- Ich kann einfache Anpassungen ( Data Cleaning/Wrangling), wie dem Ersetzen/Entfernen von NAs, Konvertierungen von Datentypen oder Definition neuer Variablen vornehmen. 
- Ich kann einfache/erste Forschungsfragen an meinen Datensatz im Sinne einer explorativen Datenanalyse stellen und auswählen, welche explorativen Diagramme sinnvoll sind. 
- Ich kann explorative Diagramme, wie Histogramme oder Boxplots mit ggplot2  erzeugen und deren Parameter anpassen.
- Ich kann einen Bericht über meine Datenanalyse verfasse (s. Wegleitung und Diskussion an der PVA) (wahlweise auch mit RMarkdown)

```{r cars}
summary(cars)
```

## Aufgabe - Einlesen Datensatz R, Variablen beschreiben, 
Lesen Sie einen selbst gewählten Datensatz in R ein und beschreiben Sie die Variablen in einer Tabelle, worin jeder Variablenname benannt wird, welches Skalenniveau (z.B. numerisch, kategorisch, nominal, etc.) sie besitzt und welche Bedeutung sie hat (z.B. Höhe des Einkommens, Alter eines Patienten etc.)

Loesung fuer das Audiofile 1727.wav Band audiofile:

```{r}
# Bibliothek laden
library(tuneR)
library(readr)
library(wrassp)
library(tibble)

# Einlesen der Audio-Datei
audiofile_band <- readWave("1727.wav") # Klassische Band

# Fehlende Werte entfernen
audiofile_band <- na.omit(audiofile_band)

# Audiodatei kuerzen
start_time <- 2000  # Start bei 2000
end_time <- 152000  # Ende nach 152000
trimmed_band <- extractWave(audiofile_band, from = start_time, to = end_time)
writeWave(trimmed_band, "1727_gekuerzt.wav")

# Path wav file, source kaggle - 1 min
audiofile_band_short <- readWave("1727_gekuerzt.wav")

# Structure audio file
str(audiofile_band_short)

# Einzelne Schalldruckwerte des monokanals konvertieren in Werte von -1 bis 1
left_channel <- audiofile_band_short@left
s1 <- left_channel / 2^(audiofile_band_short@bit -1) # 32 Bit - 1
plot(s1)

# Plotten der Druckwerte nach der Zeitachse
timeArray <- (0:(150000-1)) / audiofile_band_short@samp.rate
plot(timeArray, s1, type='l', col='black', xlab='Time (s)', ylab='Amplitude')

```
Diskussion: Die wav-Datei hat einen Kanal (links).Die Datei "1727_gekuerzt.wav" beinhaltet die gekuerte Datei.
Variablen:
  ..@ left     : num [1:150001]  -> Nominale Werte, Aussage ueber Schalldruckwerte die Intensitaet und Lautstaerke. Die Datei hat nur ein Kanal.
  ..@ right    : num(0) -> Keine Werte auf dem rechten Kanal
  ..@ stereo   : logi FALSE -> Kein Stereo
  ..@ samp.rate: int 44100 -> Abtastrate
  ..@ bit      : int 32 -> Werte-Bit-Tiefe ist auf 32 ganzzahlwerten
  ..@ pcm      : logi FALSE -> Keine Pulse-code Modulation
  
  Loesung fuer das Audiofile .m4a CornetB audifiles:
  
  
 Loesung fuer das Audiofile 1727.wav Band audiofile:
```{r}
library(tuneR)

# Definition Funkion
analyze_audio <- function(audio) {
duration <- length(audio@left) / audio@samp.rate # Dauer in Sekunden
samples <- length(audio@left) # Anzahl Samples
variance <- var(audio_data@left) # Varianz
percentiles <- quantile(abs(audio_data@left), c(0.25, 0.50, 0.75, 0.90, 0.95, 0.99))
  
analysis_audio <- list(
duration = duration,
samples = samples,
variance = variance,
percentiles_1 = percentiles[1],
percentiles_2 = percentiles[2],
percentiles_3 = percentiles[3],
percentiles_4 = percentiles[4],
percentiles_5 = percentiles[5]
)
  
  return(analysis_audio)
}

# Ausgabe
audio_file <- readWave("1727_gekuerzt.wav")
print(audio_file)
result <- analyze_audio(audio_file)
print(result)
```
## Lage- und Streumasse der numerischen Variablen
Fertigen Sie einen Überblick über Lage- und Streumasse der numerischen Variablen an.

```{r}
# Lage der numerischen Variablen
library(tuneR)
library(signal)

analyze_audio <- function(audio) {
  #Funktion Lagemass/Mittelwert
  amplitude_mean <- mean(abs(audio@left)) # Mean amplitude
  #Funktion Standardabweichung/Streuungsmass
  std_deviation <- sd(audio_data@left)

analysis_audio <- list(
  amplitude_mean = amplitude_mean,
  std_deviation = std_deviation
)
  
  return(analysis_audio)
}
# Ausgabe
audio_file <- readWave("1727_gekuerzt.wav")
print(audio_file)
result <- analyze_audio(audio_file)
print(result)
```
Die Standardabweichung von 0.027 bedeutet, dass die Datenpunkte sehr homogen sind und keine starken Abweichungen vom Mittelwert haben.

## Zwei Forschungsfragen
Formulieren Sie mindestens zwei Forschungsfragen, die Sie mit Hilfe explorativer eindimensionaler Diagramme, wie Histogramme, Balkendiagrammen oder Boxplots beantworten können/möchten.

1. Forschungsfrage: Es ist moeglich durch die statistischen Auswertungen die Toene und Lautstaerke zu unterscheiden?
2. Forschungsfrage: Es ist moeglich durch die Auswertungen zu erkennen an welchem Ort der jeweilige Ton gespielt wurde?

```{r}
# Bibliothek
library(tuneR)

# Funktion Histogramm
create_audio_histogram <- function(audio) {
audio <- readWave(audio_file) # Audiodatei einlesen
audio_mono <- audio@left # Mono-Audio erzeugen um einen x-Wert zu bekommen
hist(audio_mono, main = "Histogramm der Audiodaten", xlab = "Amplitude", ylab = "Häufigkeit", col = "skyblue", border = "black") # Histogramm
}

# Histogramm erstellen
audio_file <- "1727_gekuerzt.wav" # Pfad zur Audiodatei
create_audio_histogram(audio_file) # Histogramm der Audiodaten erstellen

## Funktion Balkendiagramm
create_audio_boxplot <- function(audio) {
audio_file <- "pfad/zum/audiofile.mp3" # Pfad zum Audio-File
audio <- readMP3(audio_file) # Audio-File einlesen
time <- (1:length(audio@left))/audio@samp.rate # Zeitvektor für das Audio-File erstellen
amplitudes <- audio@left # Amplituden des linken Audiokanals extrahieren
barplot(amplitudes, names.arg = time, xlab = "Zeit (s)", ylab = "Amplitude", col = "blue", main = "Amplitudenverlauf des Audio-Files") # Balkendiagramm erstellen
audio_file <- "pfad/zum/audiofile.mp3" # Pfad zum Audio-File
audio <- readMP3(audio_file) # Audio-File einlesen
amplitudes <- audio@left # Amplituden des linken Audiokanals extrahieren
}

# Boxplot erstellen
boxplot(amplitudes, ylab = "Amplitude", main = "Boxplot der Amplituden des Audio-Files")

```# Balkendiagramm erstellen
Analyse-Historgram: 
Analyse-Balkendiagramm:
Analyse-Boxplots:

## Sortieren Datensatz
Sortieren Sie den Datensatz nach mindestens einer Variablen.